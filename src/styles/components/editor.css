/* ===== Ernst Editor - Editor & Tab Styles ===== */

/* Editor Area */
.ernst-editor-area {
  height: 100vh;
  width: 100vw;
  display: flex;
  flex-direction: column;
  min-width: 500px; /* Monaco Editor が適切に動作する最小幅 */
}

.editor-container {
  flex: 1;
  display: flex;
  flex-direction: column;
  background-color: var(--col-bg);
}

/* Editor Header */
.ernst-editor-header {
  height: var(--editor-header-height);
  background-color: var(--col-bg);
  border-bottom: 0px solid var(--col-frnt-dark-alpha-20);
  display: flex;
  align-items: center;
  /* overflow: hidden を削除してタブスクロールが阻害されないようにする */
}

.tabs-container {
  background-color: var(--col-bg-bright);
  border-bottom: 0px solid var(--col-frnt-dark-alpha-20);
}

/* Tab Area */
.ernst-tab-area {
  display: flex;
  align-items: center;
  font-size: var(--font-size-ui-tabs);
  color: var(--col-frnt);
  overflow-x: auto; /* autoに変更してスクロールが必要な時だけ表示 */
  overflow-y: hidden;
  flex: 1; /* flex-grow: 1からflex: 1に変更 */
  min-width: 0; /* フレックスアイテムの最小幅を0にしてoverflow可能にする */
  white-space: nowrap; /* 改行を防いで水平スクロールを促進 */
  /* ネイティブスクロールバーを非表示 */
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none; /* Internet Explorer 10+ */
}

/* WebKit系ブラウザでスクロールバーを非表示 */
.ernst-tab-area::-webkit-scrollbar {
  display: none;
}

.ernst-tab {
  padding: 0 12px;
  height: var(--editor-header-height);
  display: inline-flex; /* inline-flexに変更して横並びを確実にする */
  align-items: center;
  background-color: var(--col-bg);
  border-right: 0px solid var(--col-frnt-dark-alpha-20);
  cursor: pointer;
  color: var(--col-frnt-dark);
  font-size: var(--font-size-ui-tabs);
  min-width: 120px;
  max-width: 200px;
  flex-shrink: 0; /* タブが縮小されないようにして横スクロールを促進 */
  white-space: nowrap; /* テキストの改行を防ぐ */
  /* transition: background-color var(--transition-fast), color var(--transition-fast); */
  position: relative;
}

.ernst-tab:hover {
  background-color: var(--col-bg-bright);
  color: var(--col-frnt);
}

.ernst-tab.active {
  background-color: var(--col-bg-bright);
  color: var(--col-frnt);
}

.ernst-tab.dirty .ernst-tab-name {
  font-style: italic;
}

/* ドラッグアンドドロップ状態のスタイル */
.ernst-tab.dragging {
  opacity: 0.5;
  transform: rotate(2deg);
  transition: opacity 0.2s ease, transform 0.2s ease;
}

.ernst-tab.drag-over {
  border-left: 2px solid var(--col-bg-dark);
  background-color: var(--col-gsuc-alpha-10);
}

.ernst-tab-icon {
  margin-right: 6px;
  flex-shrink: 0;
  font-size: var(--font-size-ui-icon) !important;
}

.ernst-tab-name {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  margin-right: 6px;
  margin-bottom: 2px;
}

.ernst-dirty-indicator {
  color: var(--col-frnt-dark);
  margin-left: 6px;
}

.ernst-tab-close {
  background: none;
  border: none;
  color: var(--col-frnt-dark);
  cursor: pointer;
  font-size: var(--font-size-ui-small);
  padding: 2px 4px;
  border-radius: 2px;
  margin-bottom: -2px;
  flex-shrink: 0;
  opacity: 0;
  /* transition: opacity var(--transition-fast), background-color var(--transition-fast); */
}

.ernst-tab:hover .ernst-tab-close {
  opacity: 1;
}

.ernst-tab-close:hover {
  color: var(--col-frnt);
}

.ernst-tab-close .material-symbols-outlined {
  font-size: var(--font-size-ui-small) !important;
}

.ernst-placeholder-text {
  padding: 0 12px;
  color: var(--col-frnt-dark);
  font-size: var(--font-size-ui-base);
}

/* Editor Container */
.ernst-editor-container {
  flex: 1;
  display: flex;
  flex-direction: column;
  min-width: 0; /* フレックスアイテムの自然な最小幅計算を有効にする */
}

/* Empty State */
.ernst-empty-state {
  flex: 1;
  background-color: var(--col-bg);
}

.ernst-monaco-container {
  width: 100%;
  height: 100%;
  flex: 1;
  min-width: 0; /* フレックスアイテムの自然な最小幅計算を有効にする */
}

/* ===== Monaco Editor Advanced Styles ===== */

/* Monaco エディタのフォント設定 */
.monaco-editor {
  font-family: var(--font-mono) !important;
  font-weight: 400;
  line-height: 1.2;
  letter-spacing: 0;
}

/* フォーカス時の青い境界線を完全に削除 */
.monaco-editor .focused,
.monaco-editor:focus,
.monaco-editor-group-container.active,
.monaco-editor .inputarea:focus,
.monaco-editor .view-overlays .focused {
  outline: none !important;
  border-color: transparent !important;
}

/* エラー下線スタイルをカスタマイズ */
.monaco-editor .squiggly-error {
  background: url("data:image/svg+xml,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%206%203'%20enable-background%3D'new%200%200%206%203'%20height%3D'3'%20width%3D'6'%3E%3Cg%20fill%3D'%23FE8565'%3E%3Cpolygon%20points%3D'5.5%2C0%202.5%2C3%201.1%2C3%204.1%2C0'%2F%3E%3Cpolygon%20points%3D'4%2C0%206%2C2%206%2C0.6%205.4%2C0'%2F%3E%3Cpolygon%20points%3D'0%2C2%201%2C3%202.4%2C3%200%2C0.6'%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E") repeat-x bottom left !important;
}

/* エラーガターアイコンの色も変更 */
.monaco-editor .marker-widget.error {
  border-left-color: var(--col-error) !important;
}

/* エラー概要ルーラーの色も変更 */
.monaco-editor .editorOverviewRuler .errorForeground {
  background-color: var(--col-error) !important;
}

/* エラー行のハイライト色も変更 */
.monaco-editor .monaco-editor-background .errorHighlight {
  background-color: var(--col-error-alpha-20) !important;
  border: none !important;
}

/* 概要ルーラーのエラーマーカー色を変更 */
.monaco-editor .decorationsOverviewRuler .errorOverviewRuler,
.monaco-editor .decorationsOverviewRuler div[class*="errorForeground"],
.monaco-editor .decorationsOverviewRuler .error,
.monaco-editor-background .decorationsOverviewRuler .errorForeground {
  background-color: var(--col-error) !important;
}

/* スクロールバー領域のエラーマーカー */
.monaco-scrollable-element .decorationsOverviewRuler .errorOverviewRuler {
  background-color: var(--col-error) !important;
}

/* カスタム型参照のハイライト */
.monaco-editor .custom-type-reference {
  color: var(--col-suc);
  font-style: normal;
  font-weight: bold;
}

/* 検索関連のアイコン修正 */
.monaco-editor .find-widget .button {
  background-position: center center;
  background-repeat: no-repeat;
  background-size: 16px;
}

/* スクロールバー領域の背景色を修正 */
.monaco-editor .scrollbar {
  background-color: var(--col-bg) !important;
}

/* 右端のスクロールバー背景 */
.monaco-scrollable-element > .scrollbar.vertical,
.monaco-scrollable-element > .scrollbar.vertical .slider-container {
  background-color: var(--col-bg) !important;
}

/* 下部のスクロールバー背景 */
.monaco-scrollable-element > .scrollbar.horizontal,
.monaco-scrollable-element > .scrollbar.horizontal .slider-container {
  background-color: var(--col-bg) !important;
}

/* スクロールバー周辺の影を削除 */
.monaco-scrollable-element > .shadow {
  display: none !important;
}

/* デコレーションマージンの背景色（行番号がある左側部分など） */
.monaco-editor .margin {
  background-color: var(--col-bg) !important;
}

/* モノトーンテーマ専用のスタイル */
.monaco-editor.vs-dark[data-theme='ernst-monotone'] .view-line {
  background-color: var(--col-bg) !important;
}

.monaco-editor.vs-dark[data-theme='ernst-dark'] .view-line {
  background-color: transparent !important;
}

